{% extends "layout_admin.html" %}

{% load static %}
{% block title %}Yeni Yazı | Şeyma{% endblock title %} 

{% block css_file %}
<style>
  :root {
    --primary-color: #6c5ce7;
    --primary-light: #a29bfe;
    --primary-dark: #5649c9;
    --text-dark: #2d3436;
    --text-light: #636e72;
    --bg-light: #f8f9fa;
    --success: #00b894;
    --danger: #d63031;
    --warning: #fdcb6e;
    --border-radius: 12px;
    --transition: all 0.3s ease;
    --shadow: 0 5px 25px rgba(0,0,0,0.08);
  }
  
  .main-content {
    padding: 2rem;
  }
  
  .section-box {
    background: white;
    border-radius: var(--border-radius);
    padding: 2.5rem;
    box-shadow: var(--shadow);
    margin-bottom: 2rem;
  }
  
  .section-header {
    color: var(--primary-color);
    font-weight: 600;
    margin-bottom: 2rem;
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--bg-light);
  }
  
  .form-label {
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.8rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .form-control, .form-select {
    border-radius: var(--border-radius);
    border: 2px solid #e9ecef;
    padding: 0.875rem 1rem;
    font-size: 1rem;
    transition: var(--transition);
  }
  
  .form-control:focus, .form-select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.1);
  }
  
  .form-check {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    margin: 1.5rem 0;
  }
  
  .form-check-input {
    width: 20px;
    height: 20px;
    margin: 0;
  }
  
  .form-check-input:checked {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
  }
  
  .form-check-label {
    font-weight: 500;
    color: var(--text-dark);
  }
  
  .btn-primary {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    border: none;
    border-radius: var(--border-radius);
    padding: 1rem 2.5rem;
    font-weight: 600;
    font-size: 1.1rem;
    transition: var(--transition);
  }
  
  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(108, 92, 231, 0.3);
  }
  
  .btn-secondary {
    background: #f8f9fa;
    color: var(--text-dark);
    border: 1px solid #dee2e6;
    border-radius: var(--border-radius);
    padding: 1rem 2rem;
    font-weight: 600;
    font-size: 1.1rem;
    transition: var(--transition);
  }
  
  .btn-secondary:hover {
    background: #e9ecef;
  }
  
  .alert {
    border-radius: var(--border-radius);
    border: none;
    padding: 1.2rem 1.5rem;
    margin-bottom: 2rem;
    display: flex;
    align-items: center;
    gap: 0.8rem;
  }
  
  .alert-danger {
    background: linear-gradient(135deg, var(--danger), #c23616);
    color: white;
  }
  
  .image-preview {
    margin-top: 1rem;
    display: none;
    max-width: 300px;
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--shadow);
  }
  
  .image-preview img {
    width: 100%;
    height: auto;
  }
  
  /* CKEditor Stili */
  .cke_chrome {
    border-radius: var(--border-radius) !important;
    border: 2px solid #e9ecef !important;
    overflow: hidden;
    margin-bottom: 1rem;
  }
  
  .cke_top {
    border-bottom: 1px solid #e9ecef !important;
    background: #f8f9fa !important;
  }
  
  .cke_bottom {
    border-top: 1px solid #e9ecef !important;
    background: #f8f9fa !important;
  }
  
  /* Responsive */
  @media (max-width: 768px) {
    .main-content {
      padding: 1.5rem;
    }
    
    .section-box {
      padding: 2rem;
    }
    
    .section-header {
      font-size: 1.3rem;
    }
  }
  
  @media (max-width: 480px) {
    .main-content {
      padding: 1rem;
    }
    
    .section-box {
      padding: 1.5rem;
    }
    
    .btn-primary, .btn-secondary {
      width: 100%;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    
    .button-group {
      display: flex;
      flex-direction: column;
    }
  }
</style>
{% endblock css_file %}

{% block content %}
<!-- Yazı Yazma Alanı -->
<div class="main-content">
  <div class="section-box">
    <div class="section-header">
      <i class="fas fa-edit"></i> Yeni Yazı Oluştur
    </div>
    
    <form action="{% url 'admin-paneli' %}" method="POST" enctype="multipart/form-data">
      {% csrf_token %}
      
      {% if error %}
      <div class="alert alert-danger">
        <i class="fas fa-exclamation-circle"></i>
        {{ msg }}
      </div>
      {% endif %}
      
      <!-- Başlık -->
      <div class="mb-4">
        <label for="title" class="form-label">
          <i class="fas fa-heading"></i> Başlık
        </label>
        <input type="text" name="title" class="form-control" id="title" 
               placeholder="Yazı başlığını girin..." required>
      </div>
      
      <!-- İçerik -->
      <div class="mb-4">
        <label for="editor" class="form-label">
          <i class="fas fa-file-alt"></i> İçerik
        </label>
        <textarea class="form-control" name="description" id="editor" rows="8" 
                  placeholder="Yazı içeriğini buraya girin..." required></textarea>
      </div>
      
      <!-- Kategori -->
      <div class="mb-4">
        <label for="category" class="form-label">
          <i class="fas fa-folder"></i> Kategori
        </label>
        <select name="category" class="form-select" id="category" required>
          <option value="">Kategori seçin</option>
          {% for cat in kategoriler %}
          <option value="{{ cat.id }}">{{ cat.name }}</option>
          {% endfor %}
        </select>
      </div>
      
      <!-- Fotoğraf -->
      <div class="mb-4">
        <label for="imageUrl" class="form-label">
          <i class="fas fa-image"></i> Fotoğraf
        </label>
        <input type="file" name="image" class="form-control" id="imageUrl" 
               accept="image/*" onchange="previewImage(this)">
        <div class="form-text">JPEG, PNG veya JPG formatında yükleyin</div>
        
        <!-- Resim önizleme -->
        <div class="image-preview" id="imagePreview">
          <img src="" alt="Resim önizleme">
        </div>
      </div>
      
      <!-- Aktiflik -->
      <div class="form-check form-switch mb-4">
        <input type="checkbox" name="isActive" class="form-check-input" id="isActive" checked>
        <label for="isActive" class="form-check-label">
          <i class="fas fa-eye"></i> Yayında göster
        </label>
      </div>
      
      <!-- Butonlar -->
      <div class="button-group d-flex gap-3">
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-paper-plane me-2"></i> Yayımla
        </button>
        <a href="{% url 'admin-yazi-listesi' %}" class="btn btn-secondary">
          <i class="fas fa-times me-2"></i> İptal
        </a>
      </div>
    </form>
  </div>
</div>

<!-- CKEditor -->
<script src="https://cdn.ckeditor.com/4.22.1/full/ckeditor.js"></script>
<script>
  // CKEditor konfigürasyonu
  CKEDITOR.replace('editor', {
    height: 400,
    toolbar: [
      { name: 'document', items: ['Source', '-', 'Save', 'NewPage', 'Preview', 'Print', '-', 'Templates'] },
      { name: 'clipboard', items: ['Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo'] },
      { name: 'editing', items: ['Find', 'Replace', '-', 'SelectAll', '-', 'Scayt'] },
      { name: 'forms', items: ['Form', 'Checkbox', 'Radio', 'TextField', 'Textarea', 'Select', 'Button', 'ImageButton', 'HiddenField'] },
      '/',
      { name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike', 'Subscript', 'Superscript', '-', 'CopyFormatting', 'RemoveFormat'] },
      { name: 'paragraph', items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote', 'CreateDiv', '-', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock', '-', 'BidiLtr', 'BidiRtl', 'Language'] },
      { name: 'links', items: ['Link', 'Unlink', 'Anchor'] },
      { name: 'insert', items: ['Image', 'Flash', 'Table', 'HorizontalRule', 'Smiley', 'SpecialChar', 'PageBreak', 'Iframe'] },
      '/',
      { name: 'styles', items: ['Styles', 'Format', 'Font', 'FontSize'] },
      { name: 'colors', items: ['TextColor', 'BGColor'] },
      { name: 'tools', items: ['Maximize', 'ShowBlocks'] },
      { name: 'about', items: ['About'] }
    ],
    extraPlugins: 'colorbutton,font',
    removeButtons: 'PasteFromWord'
  });
  
  // Resim önizleme fonksiyonu
  function previewImage(input) {
    const preview = document.getElementById('imagePreview');
    const img = preview.querySelector('img');
    
    if (input.files && input.files[0]) {
      const reader = new FileReader();
      
      reader.onload = function(e) {
        img.src = e.target.result;
        preview.style.display = 'block';
      }
      
      reader.readAsDataURL(input.files[0]);
    } else {
      preview.style.display = 'none';
      img.src = '';
    }
  }
</script>
{% endblock content %}